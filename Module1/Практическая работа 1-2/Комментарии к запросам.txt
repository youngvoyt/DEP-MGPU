Задание 1: Продажи по городам
Логика: Группировка данных по географической иерархии (город-штат-страна) с агрегацией ключевых метрик

Типы данных: Использованы NUMERIC для денежных метрик, INTEGER для счетчиков

Индексы: Используются индексы на geo_id в sales_fact и geo_dim для быстрых JOIN

Особенности: Сортировка по убыванию продаж для быстрого выявления лидеров

Задание 2: Прибыль по сегментам
Логика: Анализ прибыльности бизнес-сегментов с расчетом дополнительных метрик (маржа прибыли)

Типы данных: NUMERIC с высокой точностью для финансовых расчетов

Индексы: Используются индексы на segment в product_dim и prod_id в sales_fact

Особенности: Материализованная таблица для хранения агрегированных данных

Задание 3: Средняя скидка по категориям
Логика: Анализ политики ценообразования через статистику по скидкам

Типы данных: NUMERIC для точного представления процентов скидок

Индексы: Индексы на category в product_dim для эффективной группировки

Особенности: Перевод скидок в проценты для лучшей интерпретации